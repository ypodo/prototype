<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
<head>
<!-- swfobject is a commonly used library to embed Flash content -->
<script type="text/javascript"
	src="https://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js"></script>
<br><br><br><br>
<!-- Setup the recorder interface -->
<script type="text/javascript" src="assets/recorder.js"></script>
<!-- GUI code... take it or leave it -->
<script type="text/javascript" src="assets/gui.js"></script>
<script>
	function setupRecorder() {
		Wami.setup({
			id : "wami",
			onReady : setupGUI
		});
	}

	function setupGUI() {
		var gui = new Wami.GUI({
			id : "wami",
			recordUrl : "http://<%=request.host_with_port%>/wami/",
			<% if !record_exist %>   
				playUrl : "http://<%=request.host_with_port%>/no-record.wav"
			<%else%>	   				
				playUrl : "http://<%=request.host_with_port%>/nfs-share/<%=@user.id%>/<%=@user.id%>.wav"
			<%end%>

		});

		gui.setPlayEnabled(true);
		<% if !record_exist %>   
			wamiNotificationArea.innerHTML = "Please record your message!";
		<%else%>
			wamiNotificationArea.innerHTML = "You have already recorded your message";
		<%end%>			
	}
</script>
</head>

<body onload="setupRecorder()">
	<div id="wami" style="margin-left: 100px;"></div>
	<noscript>WAMI requires Javascript</noscript>
<br>
<br><br><br><br><br><br><br>
<div id="wamiNotificationArea">
</div>

</body>
</html>